<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Keep Team">
    
    <title>
        
        Keep Theme
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/logo.svg">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"Keep Theme","author":"Keep Team","avatar":"/images/avatar.svg","logo":"/images/logo.svg","favicon":"/images/logo.svg"},"menu":{"home":"/","archives":"/archives"},"first_screen":{"enable":false,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":false,"hide_header":true},"home":{"announcement":null,"category":false,"tag":false,"post_datetime":"updated"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":false,"min2read":false},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":false,"style":"default"},"highlight_theme":"default"},"toc":{"enable":false,"number":false,"expand_all":false,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":false,"site_uv":false,"site_pv":false,"page_pv":false}},"local_search":{"enable":false,"preload":false},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.36"},"waline":{"server_url":null,"reaction":false,"version":"3.2.1"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":false},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2020,"word_count":false,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.2.3"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original post title","author":"Original post author","link":"Original post link"}
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/logo.svg">
                </a>
            
            <a class="site-name border-box" href="/">
               Keep Theme
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                HOME
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                ARCHIVES
                                
                            </a>
                            
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                            HOME
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                            ARCHIVES
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/avatar.svg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">Keep Team</span>
                                
                                    <span class="author-badge">Lv4</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2025-05-15 22:26:55</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Thu May 15 2025 22:22:35 GMT+0800">2025-05-15 22:22:35</span>
            </span>
        

        

        

        
        
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <h1 id="结合项目的问题"><a href="#结合项目的问题" class="headerlink" title="结合项目的问题"></a>结合项目的问题</h1><h2 id="自我介绍"><a href="#自我介绍" class="headerlink" title="自我介绍"></a>自我介绍</h2><ul>
<li><p>您好，我叫何定贤，毕业于东北林业大学计算机专业，目前求职方向是前端开发岗位。</p>
<p>在校期间，我参与了多个实战项目。我熟悉 Vue2 和 Vue3，熟练使用 Element Plus 组件库，并能够结合 Electron 开发跨平台桌面应用。在性能优化方面，我有较深入的理解，比如基于 Lighthouse 工具进行性能分析，以及通过事件防抖、虚拟滚动等方式优化前端响应速度和用户体验。</p>
<p>在快商通实习期间，我主导负责了智能外呼系统的开发维护，主要负责数据可视化、聊天记录加载优化和前端性能提升，高亮搜索等需求开发工作，项目中使用 ECharts 和 WebSocket，实现了实时通信与数据动态展示。</p>
<p>此外，我熟练使用 Git，有丰富的团队协作经验，也具备一定的后端基础，对前后端联调和整体架构有清晰的理解。平时我喜欢写博客总结技术问题，也经常使用 ChatGPT 和 DeepSeek 来辅助学习和开发，持续提升自己的工程能力和学习效率。</p>
<p>希望加入贵公司。</p>
</li>
</ul>
<h2 id="谈谈你实习遇到的困难和解决了什么问题"><a href="#谈谈你实习遇到的困难和解决了什么问题" class="headerlink" title="谈谈你实习遇到的困难和解决了什么问题"></a>谈谈你实习遇到的困难和解决了什么问题</h2><h3 id="高亮词汇处理"><a href="#高亮词汇处理" class="headerlink" title="高亮词汇处理"></a>高亮词汇处理</h3><h3 id="1-数据绑定和监听"><a href="#1-数据绑定和监听" class="headerlink" title="1. 数据绑定和监听"></a>1. <strong>数据绑定和监听</strong></h3><ul>
<li><p>使用  <code>keyWords</code>  作为搜索关键字的绑定数据。</p>
</li>
<li><p>通过  <code>v-model</code>  将输入框的值绑定到  <code>keyWords</code>，并监听其变化：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-input</span><br><span class="line">  type=<span class="string">&quot;search&quot;</span></span><br><span class="line">  v-model=<span class="string">&quot;keyWords&quot;</span></span><br><span class="line">  placeholder=<span class="string">&quot;请输入搜索内容&quot;</span></span><br><span class="line">  style=<span class="string">&quot;width:140px;margin-top: 10px;&quot;</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在  <code>watch</code>  中监听  <code>keyWords</code>  的变化，当值发生变化时触发  <code>search</code>  方法：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">  <span class="attr">keyWords</span>: <span class="keyword">function</span> (<span class="params">newVal, oldVal</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!!newVal) <span class="variable language_">this</span>.<span class="title function_">search</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-高亮逻辑"><a href="#2-高亮逻辑" class="headerlink" title="2. 高亮逻辑"></a>2. <strong>高亮逻辑</strong></h3><ul>
<li><p>在  <code>highlightText</code>  方法中，通过正则表达式将关键字替换为带有高亮样式的 HTML：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">highlightText</span>(<span class="params">text, keyword</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="title class_">RegExp</span>(keyword, <span class="string">&#x27;gi&#x27;</span>); <span class="comment">// 全局搜索且不区分大小写</span></span><br><span class="line">  <span class="keyword">return</span> text.<span class="title function_">replace</span>(regex, <span class="function"><span class="params">match</span> =&gt;</span> <span class="string">`&lt;span class=&quot;highlight&quot;&gt;<span class="subst">$&#123;match&#125;</span>&lt;/span&gt;`</span>);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>在模板中，通过  <code>v-html</code>  动态渲染高亮后的文本：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-html=<span class="string">&quot;highlightText(jtem[0], keyWords)&quot;</span>&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="3-样式定义"><a href="#3-样式定义" class="headerlink" title="3. 样式定义"></a>3. <strong>样式定义</strong></h3><ul>
<li><p>高亮的样式通过 CSS 定义：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">::v-deep .<span class="property">highlight</span> &#123;</span><br><span class="line">  <span class="attr">color</span>:  <span class="title function_">rgb</span>(<span class="number">255</span>, <span class="number">0</span>, <span class="number">55</span>); <span class="comment">/* 高亮颜色 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="4-搜索功能"><a href="#4-搜索功能" class="headerlink" title="4. 搜索功能"></a>4. <strong>搜索功能</strong></h3><ul>
<li><p>在  <code>search</code>  方法中，遍历文本内容，找到包含关键字的项，并记录其索引位置：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">search</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">checkIndex</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">locations</span> = [];</span><br><span class="line">  <span class="keyword">if</span> (!!<span class="variable language_">this</span>.<span class="property">keyWords</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">tmpSearch</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">i, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (i.<span class="title function_">includes</span>(<span class="variable language_">this</span>.<span class="property">keyWords</span>)) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">locations</span>.<span class="title function_">push</span>(index);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">scrollToText</span>(<span class="variable language_">this</span>.<span class="property">checkIndex</span>);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="5-定位功能"><a href="#5-定位功能" class="headerlink" title="5. 定位功能"></a>5. <strong>定位功能</strong></h3><ul>
<li><p>通过  <code>scrollToText</code>  方法，将当前高亮的文本滚动到可见区域：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">scrollToText</span>(<span class="params">index</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> searchedTextEle = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;spText&quot;</span> + <span class="variable language_">this</span>.<span class="property">locations</span>[index]);</span><br><span class="line">    <span class="keyword">if</span> (searchedTextEle) &#123;</span><br><span class="line">      searchedTextEle.<span class="title function_">scrollIntoView</span>(&#123; <span class="attr">behavior</span>: <span class="string">&quot;smooth&quot;</span>, <span class="attr">block</span>: <span class="string">&quot;end&quot;</span>, <span class="attr">inline</span>: <span class="string">&quot;end&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="6-上下切换功能"><a href="#6-上下切换功能" class="headerlink" title="6. 上下切换功能"></a>6. <strong>上下切换功能</strong></h3><ul>
<li><p>使用  <code>next</code>  和  <code>previous</code>  方法切换高亮的匹配项：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">next</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">checkIndex</span> + <span class="number">1</span> &lt;= <span class="variable language_">this</span>.<span class="property">locations</span>.<span class="property">length</span> - <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">scrollToText</span>(++<span class="variable language_">this</span>.<span class="property">checkIndex</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">previous</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">checkIndex</span> - <span class="number">1</span> &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">scrollToText</span>(--<span class="variable language_">this</span>.<span class="property">checkIndex</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>设计的高亮词汇需求是没有问题的，在搜索的时候确实能够将搜搜的词汇高亮，同时再点击下一个的时候也能正常滚动，但是触发文字对话的功能又出 bug 了</p>
</li>
<li><p>因为之前点击事件绑定在文字 span 元素上，触发 handleText 方法,我用的方法是但是其实是将应该绑定的是 span 上的参数，在事件处理函数  <code>handleText</code>  中，<code>event.target</code>  指向的是触发事件的最内层元素，也就是  <code>div</code>  但是实际上绑定的数据并不在内层里，当时我尝试过在内层阻止冒泡调用 click.stop 但是最后失败了因为数据不在内层，这里有两种方法，可以直接把参数传到内层，但是我采用的是直接修改 event 属性 currentTarget。而  <code>event.currentTarget</code>  指向的是绑定事件的元素，即  <code>span</code><strong>，但是我在调试的时候发现 event.currentTarget 是空的，不知道发生了什么</strong> （这里可以作为反问环节）</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">handleText</span>(<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">audioPlayer</span>.<span class="property">$refs</span>.<span class="property">audio</span>.<span class="property">currentTime</span> = event.<span class="property">target</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;start_s&quot;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;play000000000000000000000000&#x27;</span>)</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">audioPlayer</span>.<span class="title function_">play</span>()</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<h3 id="提到了冒泡机制谈一谈你对冒泡机制的理解"><a href="#提到了冒泡机制谈一谈你对冒泡机制的理解" class="headerlink" title="提到了冒泡机制谈一谈你对冒泡机制的理解"></a>提到了冒泡机制谈一谈你对冒泡机制的理解</h3><h3 id="监听剪切板是怎么实现的，为什么这么设计？"><a href="#监听剪切板是怎么实现的，为什么这么设计？" class="headerlink" title="监听剪切板是怎么实现的，为什么这么设计？"></a>监听剪切板是怎么实现的，为什么这么设计？</h3><h3 id="怎么处理的万级数据的加载？"><a href="#怎么处理的万级数据的加载？" class="headerlink" title="怎么处理的万级数据的加载？"></a>怎么处理的万级数据的加载？</h3><h2 id="怎么对接的AI服务"><a href="#怎么对接的AI服务" class="headerlink" title="怎么对接的AI服务"></a>怎么对接的AI服务</h2><script>
import service from '@/utils/request.js'
import { ElMessage } from 'element-plus'
import { ClickOutside as vClickOutside } from 'element-plus'

const { ipcRenderer } = require('electron')
import mitt from '@/utils/mitt.js'
//import service from '@/utils/request.js'
const config = require('./config/index.js')

ipcRenderer.on('open-elf-and-sendMessage', (event) => {
  console.log('进入elf页面了----------')
  mitt.emit('openElf-send')
})

ipcRenderer.on('close-elf-elf', (event) => {
  mitt.emit('closeElf')
})

const { BrowserWindow } = require('@electron/remote')
const dayjs = require('dayjs')
export default {
  openElfTimes: 0,
  name: 'Elf',
  directives: {
    ClickOutside: vClickOutside,
  },
  data() {
    return {
      openElfTimes: 0, //打开小助手
      drawer: false,
      msgTextAry: [
        {
          message: '输入您的需求,我尽力帮助您',
          type: 'speechs'
        }
      ],
      msg: [], //聊天记录
      ping_inter: '',
      closeWebSocket: false,
      webSocket: {},
      speechData: [],
      userId: '',
      textarea: '',
      showSize: true,
      currentPage: 1,
      pageSize: 10,
      totalMessages: 0,
      loading: false,
      hasMore: true //是否有更多消息
    }
  },
  computed: {
    formattedMessages() {
      var array = this.checkShowRule(this.msg, 'createTime');
      console.log('array', array)
      return this.checkShowRule(this.msg, 'createTime');
    }
  },

  watch: {},
  mounted() {
    this.debounceF = this.debounce(this.openElf, 300)
    // this.$nextTick(() => {
    //   const container = this.$refs.chatContainer
    //   if (container) {
    //     container.addEventListener('scroll', this.handleScroll)
    //   }
    // })
    // this.init()
    this.userId = this.$store.state.baseStore.userInfo.jti
    // this.selectSpeechDataByUserId()
    //先解除绑定，再绑定(因为不解除绑定的话刷新页面会存在多个绑定)
    mitt.off('openElf-send')
    mitt.on('openElf-send', () => {
      console.log('sendReq执行了----------------------')
      this.drawer = true
      this.textarea = window.electron.store.get('customerPhone')
      this.sendReq()
      ipcRenderer.send('show-mainWindow')
    })
    //先解除绑定，再绑定(因为不解除绑定的话刷新页面会存在多个绑定)
    mitt.off('closeElf')
    mitt.on('closeElf', () => {
      //关闭聊天面板
      this.drawer = false
    })
  },
  created() {
    this.showSize = this.getWindowHeight() <= 670
    window.addEventListener('resize', () => {
      if (this.getWindowHeight() > 670) {
        this.showSize = false
      } else {
        this.showSize = true
      }
    })
  },
  methods: {
    //手写debounce函数
    debounce(func, delay) {
      console.log('debounce执行了----------------------')
      let timer = delay || null
      console.log('timer', timer)
      return function () {
        console.log('timer', timer)
        if (timer) clearTimeout(timer)
        timer = setTimeout(() => {
          console.log('事件执行----------------------')
          func()
        }, delay)
      }
    },
    //调用打开或者滚动事件出发的时候调用
    async loadMessages() {
      console.log('loadMessages执行了----------------------')
      console.log('hasMore', this.hasMore)
      if (this.hasMore) {
        this.currentPage++
        console.log('this.currentPage', this.currentPage)
      }
      if (this.loading || !this.hasMore) return
      this.loading = true
      const params = {
        userUuid: this.userId,
        pageSize: this.pageSize,
        currentPage: this.currentPage
      }
      try {
        const res = await service.post(`kcall/message/getMessageById`, params)
        if (res.data) {
          const newMessages = res.data || []
          console.log('newMessages', newMessages)
          this.msg = [...this.msg, ...newMessages]
          this.hasMore = res.data == null ? false : true

          console.log('hasMore======================', this.hasMore)
        }
      } catch (error) {
        console.error('消息加载失败:', error)
      } finally {
        this.loading = false
      }
    },
    handleScroll() {
      const container = this.$refs.myScrollbar
      const scrollbar = this.$refs.myScrollbar.$el.querySelector('.el-scrollbar__wrap');
      let scrollTop = scrollbar.scrollTop
      console.log('当前滚动条高度:', scrollTop)
      if (!container) return
      console.log('container', container)
      if (scrollTop <= 10) {
        this.loadMessages()
        this.$refs.myScrollbar.setScrollTop(this.$refs.chatContainer.scrollHeight);
      }
    },
    onClickedOutside() {
      if (this.drawer) {
        this.drawer = false
      }
    },
    //一键拨号
    oneClickCallPhone(phone) {
      window.phone.show2()
      ipcRenderer.send('oneClickCallPhone', phone)
      const userUuid = JSON.parse(ipcRenderer.sendSync('electron-store-get', 'userInfo')).jti
      const slideWord = {
        userUuid: userUuid
      }
      //一键拨号次数加一
      const url = 'kcall/slide-word/chatCallCountsPlusOne'
      service.post(url, slideWord).then((resp) => {
        if (resp.code === 200) {
          console.log('一键拨号次数加一成功')
        } else {
          console.log('一键拨号次数加一失败')
        }
      })
    },
    //查看通话详情
    viewCallDetails(phone) {
      // ipcRenderer.send('to-callList', this.customerPhone)
      this.drawer = false //跳转时关闭小助手
      // ipcRenderer.send('to-callList', phone)
      // mitt.emit('toTab1')
      ipcRenderer.send('to-associationList', phone)
      // mitt.emit('changeCallOrMissToTrue')
      //查看通话详情埋点
      const userUuid = JSON.parse(ipcRenderer.sendSync('electron-store-get', 'userInfo')).jti
      const chatPhone = {
        userUuid: userUuid,
        customerPhone: phone
      }
      //查看通话详情次数加一
      const url = 'kcall/chat-phone/phoneViewCountsPlusOne'
      console.log('phoneViewCountsPlusOne进来了-----------------')
      service.post(url, chatPhone).then((resp) => {
        if (resp.code === 200) {
          console.log('查看通话详情次数加一成功')
        } else {
          console.log('查看通话详情次数加一失败')
        }
      })
    },

    //处理时间格式

    //新消息，不显示
    //当天消息，显示：10:22
    //昨天消息，显示：昨天 20:41
    //今年消息，上午下午，显示：3月17日 下午16:45
    //其他消息，上午下午，显示：2020年11月2日 下午15:17

    /*不显示的条件*/
    // 新消息（小于5分钟）
    // 当天的消息（间隔不大于等于5分钟
    // 循环处理时间
    checkShowRule(arr, key) {
      var newArr = arr.map((item, index, array) => {
        console.log('msg---------------' + item)
        var obj = this.toggleTime(item[key]);
        item['show_time_type'] = obj.type;
        item['show_time'] = obj.time;
        if (index > 0) {
          item['is_show_time'] = this.compareTimeInterval(array[index - 1][key], array[index][key]);
        } else {
          item['is_show_time'] = true;
        }
        return item;
      });
      return newArr;
    },
    //根据不同时间的消息，输出不同的时间格式
    toggleTime(date) {
      var time
      var type = this.getDateDiff(date);
      // 1：新消息，2：当天消息,3：昨天消息，4：今年消息，5：其他消息
      if (type == 1) {
        time = '以下为最新消息' //新消息，不显示时间，但是要显示"以下为最新消息"
      } else if (type == 2) {
        time = dayjs(date).format('H:mm') //当天消息，显示：10:22
      } else if (type == 3) {
        time = dayjs(date).format('昨天 H:mm') //昨天消息，显示：昨天 20:41
      } else if (type == 4) {
        time = dayjs(date).format('M月D日 AH:mm').replace('AM', '上午').replace('PM', '下午') //今年消息，上午下午，显示：3月17日 下午16:45
      } else if (type == 5) {
        time = dayjs(date).format('YYYY年M月D日 AH:mm').replace('AM', '上午').replace('PM', '下午') //其他消息，上午下午，显示：2020年11月2日 下午15:17
      }
      return {
        time: time,
        type: type
      };
    },
    //判断消息类型
    getDateDiff(date) {
      var nowDate = dayjs(new Date());//当前时间
      var oldDate = dayjs(new Date(date));//参数时间
      var result
      if (nowDate.year() - oldDate.year() >= 1) {
        result = 5
      } else if (nowDate.month() - oldDate.month() >= 1 || nowDate.date() - oldDate.date() >= 2) {
        result = 4
      } else if (nowDate.date() - oldDate.date() >= 1) {
        result = 3;
      } else if (nowDate.hour() - oldDate.hour() >= 1 || nowDate.minute() - oldDate.minute() >= 5) {
        result = 2;
      } else {
        result = 1;
      }
      return result;
    },
    // 判断两个时间差是否大于5分钟
    compareTimeInterval(t1, t2) {
      return dayjs(t2) - dayjs(t1) >= 300000 ? true : false;
    },
    async openElf() {
      this.$nextTick(() => {
        console.log('滚动触发了')
        setTimeout(() => {
          if (this.$refs.myScrollbar && this.$refs.chatContainer) {
            this.$refs.myScrollbar.setScrollTop(this.$refs.chatContainer.scrollHeight);
          }
        }, 1000)
      })
      if (this.drawer == false) {
        this.msg = []
        //判断是否是开启状态
        console.log('小助手第一次打开了')
        console.log('openElfTimes:' + this.openElfTimes)
        this.loadMessages()
        const message = {
          userUuid: this.userId,
          pageSize: this.pageSize,
          currentPage: this.currentPage
        }
        service.post(`kcall/message/getMessageById`, message).then((res) => {
          this.msg = res.data
          console.log('msg:', this.msg)
          this.loading = false
        })
        service.get('kcall/data-burial-point/addClickTime/elf_open').then((resp) => {
          if (resp.code == 200) {
            console.log('埋点+1成功: ', resp)
          }
        })
      }
      this.drawer = !this.drawer
    },
    //发送问题
    sendReq() {
      var message = { 
        msg: this.textarea,
        userUuid: this.userId,
        isRobot: 0
      }
      service.post('kcall/message/saveMessage/', message).then(res => {
        this.msg.push(message)
        if (res.code === 200) {
          this.msg.push(res.data)
        }
        this.$nextTick(() => {
          this.$refs.myScrollbar.setScrollTop(this.$refs.chatContainer.scrollHeight);
        })
        return
        //下面编写其他逻辑，v1.1.2版本先return
      })
      var data = {
        message: this.textarea,
        type: 'speechs',
        sender: 'me'
      }
      this.msgTextAry.push(data)
      console.log('-----------msgTextAry-------------')
      console.log(this.msgTextAry)
      // this.sendMessage(data.type, data.message)
      this.textarea = ''
    },
    //点击通话详情
    selectCallRcord(message) {
      const msg = {
        userUuid: message.userUuid,
        msg: message.msg,
        type: message.type,
        parentId: message.parentId
      }
      service.post('/kcall/message/selectMessageCountByParentId', msg).then(res => {
        if (res.code === 200) {
          var countNumber = parseInt(res.data.countNumber)
          var userPhone = res.data.parentMsg  //用户输入的号码
          if (countNumber > 0) { //有效通话次数
            //则执行跳转,完成后return
            //下面写跳转逻辑
            this.viewCallDetails(userPhone)
            return
          }
          //否则不进行跳转
          ElMessage.error(message.msg)
        }
      })
    },
    callPhone(message) {
      var parentId = message.parentId
      service.post(`/kcall/message/selectByParentId/${parentId}`).then(res => {
        if (res.code === 200) {
          var phone = res.data.msg
          //进行跳转
          this.oneClickCallPhone(phone)
        }
      })
    },
    // //初始化ws连接
    // init() {
    //   return new Promise((resolve, reject) => {
    // const wsUrl = 'ws://' + config.gpt_ip + ':' + config.gpt_port
    // this.webSocket = new WebSocket(wsUrl + '/chatcall')
    //     // this.webSocket = new WebSocket('ws://43.155.109.224:30341/chatcall')
    //     this.webSocket = new WebSocket('ws://43.155.109.224:30344/chatcall')
    //     this.webSocket.onmessage = this.message
    //     this.webSocket.onopen = () => {
    //       console.log('连接成功')
    //       this.pingSend()
    //       resolve()
    //     }
    //     this.webSocket.onerror = () => {
    //       console.log('连接失败')
    //       reject()
    //     }
    //     this.webSocket.onclose = () => {
    //       console.log('服务端已断开连接')
    //       this.closeWebSocket = true
    //       this.closeUrl()
    //       reject()
    //     }
    //   })
    // },
    // //心跳机制
    // pingSend() {
    //   const data = {
    //     message: 'ping',
    //     type: 'ping'
    //   }
    //   this.ping_inter = setInterval(() => {
    //     this.webSocket.send(JSON.stringify(data))
    //     console.log('发送心跳-elf')
    //   }, 5000)
    // },
    // //关闭连接
    // closeUrl() {
    //   clearInterval(this.ping_inter)
    //   if (this.closeWebSocket && this.webSocket && this.webSocket.readyState != WebSocket.CLOSED) {
    //     console.log(this.webSockets)
    //     this.webSocket.close()
    //     this.closeWebSocket = false
    //     console.log('关闭连接')
    //   }
    // },
    // //发送消息
    // sendMessage(type, message) {
    //   const data = {
    //     type: type,
    //     message: message,
    //     db_name: JSON.stringify(this.speechData)
    //   }
    //   console.log('-----------sendMsgToWs-------------')
    //   console.log(data)
    //   if (this.webSocket && this.webSocket.readyState != WebSocket.CLOSED && this.webSocket.readyState != WebSocket.CONNECTING) {
    //     this.webSocket.send(JSON.stringify(data))
    //   } else {
    //     console.log('websocket连接错误')
    //   }
    // },
    // //接收消息
    // message(msg) {
    //   var data = JSON.parse(msg.data)
    //   let answerString = '';
    //   for (let i = 0; i < data.speechs.length; i++) {
    //     answerString += data.speechs[i].answer + '\n'
    //   }
    //   var result = {
    //     type: data.type,
    //     message: answerString,
    //     sender: 'ai'
    //   }
    //   console.log('-------------result------------')
    //   console.log(result)
    //   this.msgTextAry.push(result)
    //   this.$nextTick(() => {
    //     let messages = this.$refs.messages
    //     messages.scrollTop = messages.scrollHeight
    //   });
    // },
    //根据用户id查询话术库
    // selectSpeechDataByUserId() {
    //   const url = 'kcall/phone/selectSpeechDataByUserId'
    //   const userId = this.userId
    //   if (userId && userId.length > 0) {
    //     service.post(url, userId).then((resp) => {
    //       this.speechData = resp.data
    //     })
    //   }
    // },
    //获取窗口高度
    getWindowHeight() {
      let [width, height] = BrowserWindow.getFocusedWindow().getSize()
      this.height = height
      return height
    }
  }




## 二次封装实现的Echart怎么封装的？都有什么参数？雷达图怎么设计的？

## 你提到了 vue2 和 vue3，它们有什么区别？

## 谈一谈 vue3 的事件传递机制？

## 为什么 maven 使用自动更新依赖的机制，但是 vue 不使用？

- 工具定位不同，npm 是包管理工具，maven 是依赖管理工具，package 声明了依赖，但是实际版本信息会被 package-lock.json 锁定，这是为了确保以来的稳定性，防止自动更新造成的不兼容不稳定的问题

工具定位不同： vue 是包管理工具 maven 是依赖管理工具

Vue 项目中的 `package.json` 文件虽然声明了依赖，但包的实际版本信息会被 `package-lock.json` 或 `yarn.lock` 锁定。这些锁文件是为了确保依赖版本的稳定性，防止自动更新带来不兼容或不稳定的问题，因此避免了在每次运行时自动更新依赖版本。



## 毕设管理系统怎么解决的跨域问题？



- 当然后端也可以解决跨域问题,可以直接配置全部的跨域请求，也能设置某些接口的跨域 @CrossOrigin(origins = "http://localhost:3000")

- ```java
  import org.springframework.context.annotation.Bean;
  import org.springframework.context.annotation.Configuration;
  import org.springframework.web.servlet.config.annotation.CorsRegistry;
  import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;
  
  @Configuration
  public class WebConfig implements WebMvcConfigurer {
  @Override
  public void addCorsMappings(CorsRegistry registry) {
      // 配置允许跨域的路径，支持的请求方法，允许的来源等
      registry.addMapping("/**") // 允许所有路径进行跨域请求
              .allowedOrigins("http://localhost:3000") // 允许的域名，这里是前端地址
              .allowedMethods("GET", "POST", "PUT", "DELETE") // 允许的请求方法
              .allowedHeaders("*") // 允许的请求头
              .allowCredentials(true) // 是否允许携带 Cookie
              .maxAge(3600); // 缓存 CORS 配置的时间，单位是秒
  }
  }
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 最后我才用的还是前端解决，因为如果后端开启了广泛的 CORS 配置（例如允许所有域名 `*` 访问），就会造成潜在的安全隐患，尤其是在生产环境中。如果 CORS 配置不当，可能导致恶意网站访问你的 API，带来跨站脚本攻击（XSS）等安全风险。由后端直接解决跨域需要更加小心，确保跨域配置的安全性。而来也是希望后端更专注于业务逻辑的开发</span><br><span class="line"></span><br><span class="line">## 还有什么跨域解决方案吗？</span><br><span class="line"></span><br><span class="line">## 讲讲HappyPack和DllPlugin 动态链接库是怎么优化打包的?</span><br><span class="line"></span><br><span class="line">## Gzip的打包原理是什么？怎么配置的？</span><br><span class="line"></span><br><span class="line">## 具体优化了多少？</span><br><span class="line"></span><br><span class="line">## 怎么测试算法的性能？</span><br><span class="line"></span><br><span class="line">## 打包时执行npm run build发生了什么？</span><br><span class="line"></span><br><span class="line">## 讲讲你能想到的前端优化？</span><br><span class="line"></span><br><span class="line">## 装饰器怎么使用的？为什么这么设计？</span><br><span class="line"></span><br><span class="line">## 二次封装的axios都有什么？为什么二次封装？</span><br><span class="line"></span><br><span class="line">## 为什么使用 Ts 而不是 Js</span><br><span class="line"></span><br><span class="line">## 大文件上传怎么设计的，后端怎么设计的，讲讲参数是什么？怎么判断是不是一个文件？</span><br><span class="line"></span><br><span class="line">## 新雪花算法解决了什么问题？</span><br><span class="line"></span><br><span class="line">## 水平鉴权垂直鉴权是怎么做的？</span><br><span class="line"></span><br><span class="line">## 加密算法用的哪个？</span><br><span class="line"></span><br><span class="line">## 讲讲webflux</span><br><span class="line"></span><br><span class="line">## 为什么动态import导入能提升首屏加载性能</span><br><span class="line"></span><br><span class="line">## 前端性能测试都有什么怎么做的？怎么优化？</span><br><span class="line"></span><br><span class="line">## 前端缓存讲一下</span><br><span class="line"></span><br><span class="line">## 什么是前端AST语法树</span><br><span class="line"></span><br><span class="line">## 讲一讲前端时间循环机制</span><br><span class="line"></span><br><span class="line">## 你的数据库怎么设计的？ 为什么这么设计？</span><br><span class="line"></span><br><span class="line">## IndexedDB讲一下</span><br><span class="line"></span><br><span class="line">## CI/CD全流程讲一下</span><br><span class="line"></span><br><span class="line">## 怎么基于命令行创建一个空分支在github</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">git commit --allow-empty -m &quot;Initial empty commit&quot;</span><br><span class="line">git remote add origin https://github.com/username/repository.git</span><br><span class="line">git push origin master:empty-branch</span><br></pre></td></tr></table></figure>

## 

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"
                                   title="内网穿透"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">内网穿透</span>
                                        <span class="post-nav-item">Next posts</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
        &copy;&nbsp;<span>2020</span>&nbsp;-&nbsp;2025
        
            &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">Keep Team</a>
        
    </div>

    <div class="theme-info info-item">
        Powered by&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;&&nbsp;Theme&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
    </div>

    

    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        

        <!-- PC go comment -->
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    

    <!-- tablet toc -->
    
</main>





<!-- common js -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local search -->


<!-- lazyload -->


<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
